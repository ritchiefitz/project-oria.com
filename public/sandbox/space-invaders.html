<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Space Invaders - Classic arcade shooter game. Defend Earth from alien invaders!">
<title>Space Invaders - Oria Sandbox</title>
<link rel="icon" type="image/svg+xml" href="../favicon.svg">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 50%, #16213e 100%);
  color: #e4e4e7;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

header {
  padding: 1.5rem 5%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  backdrop-filter: blur(10px);
  background: rgba(10, 14, 39, 0.7);
  border-bottom: 1px solid rgba(99, 102, 241, 0.2);
}

.logo {
  font-size: 1.5rem;
  font-weight: 800;
  background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-decoration: none;
}

nav a {
  color: #a1a1aa;
  text-decoration: none;
  margin-left: 1.5rem;
  font-weight: 500;
  transition: all 0.3s ease;
}

nav a:hover {
  color: #6366f1;
}

.game-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  gap: 1.5rem;
}

.game-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  max-width: 600px;
  padding: 0 1rem;
}

.game-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: #ffffff;
}

.score-display {
  display: flex;
  gap: 2rem;
  font-size: 1.125rem;
}

.score-display span {
  color: #a1a1aa;
}

.score-display strong {
  color: #6366f1;
}

#gameCanvas {
  background: rgba(10, 14, 39, 0.9);
  border: 2px solid rgba(99, 102, 241, 0.3);
  border-radius: 12px;
  box-shadow: 0 0 40px rgba(99, 102, 241, 0.2);
}

.game-controls {
  text-align: center;
  color: #71717a;
  max-width: 600px;
}

.game-controls p {
  margin-bottom: 0.5rem;
}

.controls-row {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1rem;
}

.control-key {
  background: rgba(99, 102, 241, 0.2);
  border: 1px solid rgba(99, 102, 241, 0.3);
  padding: 0.5rem 1rem;
  border-radius: 6px;
  font-family: monospace;
  color: #a1a1aa;
}

.mobile-controls {
  display: none;
  gap: 1rem;
  margin-top: 1rem;
}

.mobile-btn {
  background: rgba(99, 102, 241, 0.3);
  border: 2px solid rgba(99, 102, 241, 0.5);
  color: #ffffff;
  padding: 1rem 2rem;
  border-radius: 8px;
  font-size: 1.5rem;
  cursor: pointer;
  user-select: none;
  touch-action: manipulation;
}

.mobile-btn:active {
  background: rgba(99, 102, 241, 0.6);
}

.fire-btn {
  background: rgba(168, 85, 247, 0.3);
  border-color: rgba(168, 85, 247, 0.5);
}

.fire-btn:active {
  background: rgba(168, 85, 247, 0.6);
}

.restart-btn {
  background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
  border: none;
  color: white;
  padding: 0.75rem 2rem;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-top: 1rem;
}

.restart-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
}

footer {
  text-align: center;
  padding: 1.5rem;
  color: #71717a;
  border-top: 1px solid rgba(99, 102, 241, 0.1);
}

@media (max-width: 768px) {
  .mobile-controls {
    display: flex;
  }

  .game-controls p:not(.mobile-hint) {
    display: none;
  }

  .controls-row {
    display: none;
  }
}

@media (max-width: 640px) {
  #gameCanvas {
    width: 100%;
    max-width: 360px;
    height: auto;
    aspect-ratio: 3/4;
  }
}
</style>
</head>
<body>
  <header>
    <a href="../index.html" class="logo">ORIA</a>
    <nav>
      <a href="../index.html">Home</a>
      <a href="index.html">Sandbox</a>
    </nav>
  </header>

  <div class="game-container">
    <div class="game-header">
      <h1 class="game-title">Space Invaders</h1>
      <div class="score-display">
        <div><span>Score:</span> <strong id="score">0</strong></div>
        <div><span>Lives:</span> <strong id="lives">3</strong></div>
        <div><span>Wave:</span> <strong id="wave">1</strong></div>
      </div>
    </div>

    <canvas id="gameCanvas" width="600" height="700"></canvas>

    <div class="game-controls">
      <p>Use arrow keys or A/D to move, Space to fire</p>
      <div class="controls-row">
        <span class="control-key">← / A</span>
        <span class="control-key">→ / D</span>
        <span class="control-key">Space</span>
      </div>
      <p class="mobile-hint" style="display: none;">Tap the buttons below to play</p>
      <div class="mobile-controls">
        <button class="mobile-btn" id="leftBtn">◀</button>
        <button class="mobile-btn fire-btn" id="fireBtn">FIRE</button>
        <button class="mobile-btn" id="rightBtn">▶</button>
      </div>
      <button class="restart-btn" id="restartBtn">New Game</button>
    </div>
  </div>

  <footer>
    <p>© 2025 Oria. Powered by artificial intelligence.</p>
  </footer>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Game state
    let score = 0;
    let lives = 3;
    let wave = 1;
    let gameOver = false;
    let gamePaused = false;

    // Player
    const player = {
      x: canvas.width / 2 - 25,
      y: canvas.height - 60,
      width: 50,
      height: 30,
      speed: 7,
      color: '#6366f1'
    };

    // Bullets
    let playerBullets = [];
    let enemyBullets = [];
    const bulletSpeed = 8;
    const enemyBulletSpeed = 4;
    let lastPlayerShot = 0;
    const playerShootCooldown = 250;

    // Enemies
    let enemies = [];
    const enemyRows = 5;
    const enemyCols = 10;
    const enemyWidth = 40;
    const enemyHeight = 30;
    const enemyPadding = 10;
    let enemyDirection = 1;
    let enemySpeed = 1;
    let enemyDropAmount = 20;

    // Shields
    let shields = [];

    // Stars (background)
    const stars = [];
    for (let i = 0; i < 100; i++) {
      stars.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2 + 0.5,
        speed: Math.random() * 0.5 + 0.2
      });
    }

    // Input handling
    const keys = {
      left: false,
      right: false,
      space: false
    };

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') keys.left = true;
      if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') keys.right = true;
      if (e.key === ' ') {
        e.preventDefault();
        keys.space = true;
      }
    });

    document.addEventListener('keyup', (e) => {
      if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') keys.left = false;
      if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') keys.right = false;
      if (e.key === ' ') keys.space = false;
    });

    // Mobile controls
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');
    const fireBtn = document.getElementById('fireBtn');

    leftBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys.left = true; });
    leftBtn.addEventListener('touchend', (e) => { e.preventDefault(); keys.left = false; });
    rightBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys.right = true; });
    rightBtn.addEventListener('touchend', (e) => { e.preventDefault(); keys.right = false; });
    fireBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys.space = true; });
    fireBtn.addEventListener('touchend', (e) => { e.preventDefault(); keys.space = false; });

    document.getElementById('restartBtn').addEventListener('click', resetGame);

    // Initialize enemies
    function createEnemies() {
      enemies = [];
      const startX = (canvas.width - (enemyCols * (enemyWidth + enemyPadding))) / 2;
      const startY = 60;

      for (let row = 0; row < enemyRows; row++) {
        for (let col = 0; col < enemyCols; col++) {
          enemies.push({
            x: startX + col * (enemyWidth + enemyPadding),
            y: startY + row * (enemyHeight + enemyPadding),
            width: enemyWidth,
            height: enemyHeight,
            type: row < 1 ? 2 : row < 3 ? 1 : 0,
            alive: true
          });
        }
      }
    }

    // Initialize shields
    function createShields() {
      shields = [];
      const shieldWidth = 70;
      const shieldHeight = 50;
      const shieldY = canvas.height - 150;
      const shieldCount = 4;
      const spacing = (canvas.width - (shieldCount * shieldWidth)) / (shieldCount + 1);

      for (let i = 0; i < shieldCount; i++) {
        const shieldX = spacing + i * (shieldWidth + spacing);
        // Create shield blocks
        for (let row = 0; row < 4; row++) {
          for (let col = 0; col < 6; col++) {
            // Skip corners to create arch shape
            if (row === 3 && (col < 2 || col > 3)) continue;
            shields.push({
              x: shieldX + col * 12,
              y: shieldY + row * 12,
              width: 12,
              height: 12,
              health: 3
            });
          }
        }
      }
    }

    function resetGame() {
      score = 0;
      lives = 3;
      wave = 1;
      gameOver = false;
      enemySpeed = 1;
      enemyDirection = 1;
      player.x = canvas.width / 2 - 25;
      playerBullets = [];
      enemyBullets = [];
      createEnemies();
      createShields();
      updateDisplay();
    }

    function updateDisplay() {
      document.getElementById('score').textContent = score;
      document.getElementById('lives').textContent = lives;
      document.getElementById('wave').textContent = wave;
    }

    function nextWave() {
      wave++;
      enemySpeed = 1 + wave * 0.3;
      enemyDirection = 1;
      playerBullets = [];
      enemyBullets = [];
      createEnemies();
      updateDisplay();
    }

    function shoot() {
      const now = Date.now();
      if (now - lastPlayerShot >= playerShootCooldown) {
        playerBullets.push({
          x: player.x + player.width / 2 - 2,
          y: player.y,
          width: 4,
          height: 15
        });
        lastPlayerShot = now;
      }
    }

    function enemyShoot() {
      const aliveEnemies = enemies.filter(e => e.alive);
      if (aliveEnemies.length > 0 && Math.random() < 0.02) {
        const shooter = aliveEnemies[Math.floor(Math.random() * aliveEnemies.length)];
        enemyBullets.push({
          x: shooter.x + shooter.width / 2 - 2,
          y: shooter.y + shooter.height,
          width: 4,
          height: 12
        });
      }
    }

    function rectCollision(r1, r2) {
      return r1.x < r2.x + r2.width &&
             r1.x + r1.width > r2.x &&
             r1.y < r2.y + r2.height &&
             r1.y + r1.height > r2.y;
    }

    function update() {
      if (gameOver) return;

      // Player movement
      if (keys.left && player.x > 0) {
        player.x -= player.speed;
      }
      if (keys.right && player.x < canvas.width - player.width) {
        player.x += player.speed;
      }
      if (keys.space) {
        shoot();
      }

      // Update player bullets
      playerBullets = playerBullets.filter(bullet => {
        bullet.y -= bulletSpeed;
        return bullet.y > -bullet.height;
      });

      // Update enemy bullets
      enemyBullets = enemyBullets.filter(bullet => {
        bullet.y += enemyBulletSpeed;
        return bullet.y < canvas.height;
      });

      // Move enemies
      let shouldDrop = false;
      const aliveEnemies = enemies.filter(e => e.alive);

      if (aliveEnemies.length > 0) {
        const leftMost = Math.min(...aliveEnemies.map(e => e.x));
        const rightMost = Math.max(...aliveEnemies.map(e => e.x + e.width));

        if (rightMost >= canvas.width - 10 && enemyDirection === 1) {
          shouldDrop = true;
          enemyDirection = -1;
        } else if (leftMost <= 10 && enemyDirection === -1) {
          shouldDrop = true;
          enemyDirection = 1;
        }
      }

      enemies.forEach(enemy => {
        if (enemy.alive) {
          if (shouldDrop) {
            enemy.y += enemyDropAmount;
          }
          enemy.x += enemySpeed * enemyDirection;
        }
      });

      // Enemy shooting
      enemyShoot();

      // Check bullet-enemy collisions
      playerBullets.forEach((bullet, bi) => {
        enemies.forEach(enemy => {
          if (enemy.alive && rectCollision(bullet, enemy)) {
            enemy.alive = false;
            playerBullets.splice(bi, 1);
            score += (enemy.type + 1) * 10;
            updateDisplay();
          }
        });
      });

      // Check bullet-shield collisions
      playerBullets.forEach((bullet, bi) => {
        shields.forEach((shield, si) => {
          if (shield.health > 0 && rectCollision(bullet, shield)) {
            shield.health--;
            playerBullets.splice(bi, 1);
          }
        });
      });

      enemyBullets.forEach((bullet, bi) => {
        shields.forEach((shield, si) => {
          if (shield.health > 0 && rectCollision(bullet, shield)) {
            shield.health--;
            enemyBullets.splice(bi, 1);
          }
        });
      });

      // Check enemy bullet-player collision
      enemyBullets.forEach((bullet, bi) => {
        if (rectCollision(bullet, player)) {
          enemyBullets.splice(bi, 1);
          lives--;
          updateDisplay();
          if (lives <= 0) {
            gameOver = true;
          }
        }
      });

      // Check enemy-player collision
      enemies.forEach(enemy => {
        if (enemy.alive && enemy.y + enemy.height >= player.y) {
          gameOver = true;
        }
      });

      // Check for wave completion
      if (aliveEnemies.length === 0) {
        nextWave();
      }

      // Update stars
      stars.forEach(star => {
        star.y += star.speed;
        if (star.y > canvas.height) {
          star.y = 0;
          star.x = Math.random() * canvas.width;
        }
      });
    }

    function drawPlayer() {
      ctx.fillStyle = player.color;
      // Draw ship body
      ctx.beginPath();
      ctx.moveTo(player.x + player.width / 2, player.y);
      ctx.lineTo(player.x + player.width, player.y + player.height);
      ctx.lineTo(player.x, player.y + player.height);
      ctx.closePath();
      ctx.fill();

      // Draw cockpit
      ctx.fillStyle = '#a855f7';
      ctx.beginPath();
      ctx.arc(player.x + player.width / 2, player.y + 15, 8, 0, Math.PI * 2);
      ctx.fill();
    }

    function drawEnemy(enemy) {
      const colors = ['#10b981', '#f59e0b', '#ef4444'];
      ctx.fillStyle = colors[enemy.type];

      if (enemy.type === 0) {
        // Basic invader
        ctx.fillRect(enemy.x + 5, enemy.y, enemy.width - 10, enemy.height);
        ctx.fillRect(enemy.x, enemy.y + 5, enemy.width, enemy.height - 10);
      } else if (enemy.type === 1) {
        // Medium invader
        ctx.beginPath();
        ctx.moveTo(enemy.x + enemy.width / 2, enemy.y);
        ctx.lineTo(enemy.x + enemy.width, enemy.y + enemy.height / 2);
        ctx.lineTo(enemy.x + enemy.width / 2, enemy.y + enemy.height);
        ctx.lineTo(enemy.x, enemy.y + enemy.height / 2);
        ctx.closePath();
        ctx.fill();
      } else {
        // Elite invader
        ctx.beginPath();
        ctx.arc(enemy.x + enemy.width / 2, enemy.y + enemy.height / 2, enemy.width / 2 - 2, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = '#0a0e27';
        ctx.beginPath();
        ctx.arc(enemy.x + enemy.width / 2, enemy.y + enemy.height / 2, enemy.width / 4, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function draw() {
      // Clear canvas
      ctx.fillStyle = '#0a0e27';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Draw stars
      ctx.fillStyle = '#ffffff';
      stars.forEach(star => {
        ctx.globalAlpha = 0.5 + Math.random() * 0.5;
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
        ctx.fill();
      });
      ctx.globalAlpha = 1;

      // Draw shields
      shields.forEach(shield => {
        if (shield.health > 0) {
          const alpha = shield.health / 3;
          ctx.fillStyle = `rgba(99, 102, 241, ${alpha})`;
          ctx.fillRect(shield.x, shield.y, shield.width, shield.height);
        }
      });

      // Draw player
      drawPlayer();

      // Draw enemies
      enemies.forEach(enemy => {
        if (enemy.alive) {
          drawEnemy(enemy);
        }
      });

      // Draw player bullets
      ctx.fillStyle = '#6366f1';
      playerBullets.forEach(bullet => {
        ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
        // Glow effect
        ctx.shadowColor = '#6366f1';
        ctx.shadowBlur = 10;
        ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
        ctx.shadowBlur = 0;
      });

      // Draw enemy bullets
      ctx.fillStyle = '#ef4444';
      enemyBullets.forEach(bullet => {
        ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
        ctx.shadowColor = '#ef4444';
        ctx.shadowBlur = 10;
        ctx.fillRect(bullet.x, bullet.y, bullet.width, bullet.height);
        ctx.shadowBlur = 0;
      });

      // Draw game over screen
      if (gameOver) {
        ctx.fillStyle = 'rgba(10, 14, 39, 0.85)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = '#ffffff';
        ctx.font = 'bold 48px Inter, sans-serif';
        ctx.textAlign = 'center';
        ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2 - 40);

        ctx.fillStyle = '#6366f1';
        ctx.font = '24px Inter, sans-serif';
        ctx.fillText(`Final Score: ${score}`, canvas.width / 2, canvas.height / 2 + 10);
        ctx.fillText(`Wave Reached: ${wave}`, canvas.width / 2, canvas.height / 2 + 45);

        ctx.fillStyle = '#a1a1aa';
        ctx.font = '18px Inter, sans-serif';
        ctx.fillText('Click "New Game" to play again', canvas.width / 2, canvas.height / 2 + 90);
      }
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    // Check for mobile
    if ('ontouchstart' in window) {
      document.querySelector('.mobile-hint').style.display = 'block';
    }

    // Initialize and start
    createEnemies();
    createShields();
    gameLoop();
  </script>
</body>
</html>
